# shellcheck shell=dash disable=2016

___x_cmd_codex___unit_get_agentfile_(){
    local dir="${1:-$PWD}"
    local config_file="${CODEX_HOME:-$HOME}/.codex/config.toml"
    local filename=""
    [ ! -f "$config_file" ] || {
        filename="$( < "$config_file" ___x_cmd_cmds awk '
(match($0, "^project_doc_fallback_filenames[ \t]+=[ \t]+\\[[ \t]*\"")){
l = substr($0, RSTART+RLENGTH)
print substr(l, 1, index(l, "\"")-1)
}
' )"
    }
    x_=""; ___x_cmd skill --unit_find_up_ "$dir" AGENTS.override.md AGENTS.md ${filename} || {
        codex:error "Failed to retrieve existing context files â€” Not found AGENTS.override.md or AGENTS.md"
        return 1
    }
}
