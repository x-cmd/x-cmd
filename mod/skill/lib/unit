# shellcheck shell=dash

___x_cmd_skill_cat(){
    local skillid="$1"
    [ -n "$skillid" ] || N=skill M="Please provide the skill id" log:ret:64
    local x_=; ___x_cmd_skill_which_ "$skillid" "SKILL.md" || return $?
    skill:info "cat $x_"
    ___x_cmd_cmds cat "$x_"
}

___x_cmd_skill_which(){
    local x_=; ___x_cmd_skill_which_ "$@" || return $?
    printf "%s\n" "$x_"
}

___x_cmd_skill_which_(){
    local skillid="$1"; [ -n "$skillid" ] || N=skill M="Please provide the skill id" log:ret:64
    local filename="$2"

    x_="$___X_CMD_SKILL_FULL_DATA_DIR/$skillid/$filename"
    [ -e "$x_" ] || N=skill M="Not found skill file -> $x_" log:ret:1
}

___x_cmd_skill___agent_check(){
    local agent="$1"
    case "$agent" in
        claude|codex|gemini)
            return 0 ;;
        "") skill:error "Please provide the agent name -> [claude|codex|gemini]"
            return 64 ;;
        *)  skill:error "Unknown agent -> $agent, must be [claude|codex|gemini]"
            return 1 ;;
    esac
}

___x_cmd_skill___fzf(){
    FZF_DEFAULT_OPTS="
--ansi
--reverse
--height='80%'
--bind='ctrl-w:toggle-preview-wrap'
--bind='ctrl-r:change-preview-window(right,70%|down,40%,99%,border-horizontal|hidden|right)'
"   ___x_cmd fzf "$@"
}
