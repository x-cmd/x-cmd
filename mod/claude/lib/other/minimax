# shellcheck shell=dash

___x_cmd_claude_minimax(){
    local op="$1"
    case "$op" in
        -h|--help)      ___x_cmd help -m claude minimax; return 0 ;;
        --)             shift ;;
    esac

    claude:provider:fetch:init
    ___x_cmd_claude_minimax___fetch_    || return $?

    ANTHROPIC_API_KEY="" API_TIMEOUT_MS="$x_timeout"    \
        ___x_cmd_claude_other___use  minimax            \
        "$x_url" "$x_apikey" "$x_model" "$x_fastmodel" "$x_nonessential_traffic" "$@"
}


___x_cmd_claude_minimax___fetch_(){
    local model=""
    local apikey=""
    local codingplan_apikey=""
    local endpoint=""

    ___x_cmd minimax --cur model:=    apikey:=    codingplan_apikey:=     endpoint:=    2>/dev/null

    if [ -n "$codingplan_apikey" ]; then
        x_apikey="$codingplan_apikey"
        x_url="https://api.minimaxi.com/anthropic"
    elif [ -n "$apikey" ]; then
        x_apikey="$apikey"
        x_url="$endpoint";  [ -n "$x_url" ] || x_url="https://api.minimaxi.com/anthropic"
    else
        claude:info \
            --tip1 'x minimax --cfg'                       \
            --tip2 'x minimax --cfg codingplan_apikey=<YOUR-CODING-PLAN-API-KEY>' \
            --tip2 'x minimax --cfg apikey=<YOUR-API-KEY>' \
            "Please setup MINIMAX API-KEY."
        return 1
    fi

    x_model="$model"
    [ -n "$x_model" ] || x_model="MiniMax-M2.5"

    x_fastmodel="$x_model"

}

