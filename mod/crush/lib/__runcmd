
___x_cmd_crush___runmain(){
    local openai_api_key="$OPENAI_API_KEY"
    local gemini_api_key="$GEMINI_API_KEY"

    [ -n "$openai_api_key" ]    || openai_api_key="$(___x_cmd openai --cur get apikey 2>/dev/null)"
    [ -n "$gemini_api_key" ]    || gemini_api_key="$(___x_cmd gemini --cur get apikey 2>/dev/null)"

    local proxy=
    ___x_cmd_crush_cur proxy:= 2>/dev/null

    OPENAI_API_KEY="$openai_api_key" GEMINI_API_KEY="$gemini_api_key" \
    ___x_cmd proxy runifset "$proxy" \
    ___x_cmd_crush___runcmd "$@"
}

___x_cmd_crush___runcmd(){
    if ___x_cmd_hascmd crush; then
        ___x_cmd_crush___runcmd(){  ___x_cmd_cmds crush "$@"; }
    else
        ___x_cmd_crush___runcmd(){ ___x_cmd snap --run crush "$@" ; }
    fi || return $?
    ___x_cmd_crush___runcmd "$@"
}
